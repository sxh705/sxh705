# 第8章_Hadoop再探讨

## 试述HDFS1.0中只包含一个名称节点会带来哪些问题

### 单点故障问题

虽然HDFS1.0中存在第二名称节点，但是在1.0版本中第二名称节点的作用是周期性的从名称节点获取命名空间镜像文件（FsImage）和修改日志（EditLog），从而来对FsImage的恢复。因此当名称节点发生故障时，系统无法实时切换到第二名称节点以对外提供服务，仍需要停机恢复。（可以通过HA来解决）

### 可拓展方面

名称节点把整个HDFS文件系统中的元数据信息都保存在自己的内存中，HDFS1.0中只有一个名称节点，不可以水平拓展，而单个名称节点的内存空间是有上限的，这限制了系统中数据块、文件和目录的数目。在系统整体性能方面，整个HDFS文件系统的性能会受限于单个名称节点的吞吐量。在隔离性方面，单个名称节点难以提供不同程序之间的隔离性，一个程序可能会影响其他运行的程序。（通过HDFS联邦来进行解决）

## 请分析HDFS HA架构中数据节点如何和名称节点保持通信。

在HDFS HA中，所有名称节点会**共享底层的数据节点**存储资源。

每个数据节点要向集群中所有的名称节点注册，并周期性地向名称节点发送心跳和块信息，报告自己的状态，同时也会处理来自名称节点的指令。

## 请阐述为什么需要HDFS联邦，即它能够解决什么问题。

因为原来的HDFS存在可拓展性，系统性能以及隔离性三个方面的问题。

联邦设计了多个相互独立的名称节点，使得HDFS的命名服务能够水平拓展。

## 请阐述MapReduce1.0体系结构中存在的问题。

### 存在单点故障

系统中只有一个JobTracker来负责所有的MapReduce作业的调度；

### JobTracker负责的任务过重

JobTracker不仅要负责作业的调度和失败恢复，同时要负责资源管理与分配；

### 容易出现内存溢出

TaskTracker资源分配时不考虑内存的实际情况。

### 资源划分不合理

资源槽之间彼此不能共通使用。

## 请分别描述Pig、Tez和Kafka的功能

### Pig是Hadoop生态的一个组件

允许用户通过编写简单的脚本来实现复杂的数据分析，而不需要编写复杂的MapReduce应用程序。

Pig会自动把用户编写的脚本转换成MapReduce作业在Hadoop集群上运行，而且具备对生成的MapReduce程序进行自动优化的功能。

### Tez直接源于MapReduce框架

核心思想是将Map和Reduce两个操作进一步进行拆分，

即**Map被拆分成Input、Processor、Sort、Merge和Output**

**Reduce被拆分成Input、Shuffle、Sort、Merge、Processor和Output等**，经过分解后的这些元操作合约进行自由任意组合产生新的操作，经过一些控制程序组装后就可以形成一个大的**DAG作业**。通过DAG作业的方式运行MapReduce作业，提供了程序运行的整体处理逻辑，就可以去除工作流当中多余的Map阶段，减少不必要的操作，提升数据处理的性能。

### Kafka是由LinkedIn公式开发的一种高吞吐量的分布式发布订阅消息系统。

用户通过Kafka系统可以发布大量的消息，同时也能实时订阅消费消息。Kafka设计的初衷是构建一个可以处理海量日志、用户行为和网站运营统计等的数据处理框架。



